{"paragraphs":[{"text":"%pyspark\nimport sys\nprint(\"Python: \", sys.version.replace(\"\\n\", \" - \"))\nprint(\"Spark:  \", sc.version)\n","user":"anonymous","dateUpdated":"2017-02-27T08:49:57+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591121_-1375374975","id":"20170226-205154_1841885464","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:49:57+0100","dateFinished":"2017-02-27T08:49:57+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3640"},{"text":"%md\n## 1 Initialize ZeppelinCommLayer","user":"anonymous","dateUpdated":"2017-02-27T09:00:23+0100","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591124_-1376529222","id":"20170222-114829_709151521","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T09:00:23+0100","dateFinished":"2017-02-27T09:00:23+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3641","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>1 Initialize ZeppelinCommLayer</h2>\n</div>"}]}},{"title":"Import the Zeppelin Comm Layer","text":"%pyspark\n\nfrom zeppelin_comm_layer import ZeppelinCommLayer, resetZeppelinCommLayer\n","user":"anonymous","dateUpdated":"2017-02-27T08:56:12+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591123_-1374605478","id":"20170222-110000_685570517","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:14+0100","dateFinished":"2017-02-27T08:48:14+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3642"},{"title":"Prepare Communication paragraph ...","text":"%pyspark\n\n# To reset both the python ZeppelinCommLayer singleton and the Javascript Jupyter object, uncomment the next line\nresetZeppelinCommLayer(z.z)  \n\nzcl = ZeppelinCommLayer(z.z, debug=False)\n","user":"anonymous","dateUpdated":"2017-02-27T08:54:11+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591124_-1376529222","id":"20170218-215455_1576137953","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:53:07+0100","dateFinished":"2017-02-27T08:53:07+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3643"},{"title":"... and start the Communication layer in the next Zeppelin paragraph","text":"%pyspark\nzcl.start()\n","user":"anonymous","dateUpdated":"2017-02-27T08:55:20+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591124_-1376529222","id":"20170226-221102_1708128437","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:53:09+0100","dateFinished":"2017-02-27T08:53:09+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3644"},{"text":"%md\n## 2 Load Bokeh and redirect output to Zeppelin","user":"anonymous","dateUpdated":"2017-02-27T09:00:25+0100","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591125_-1376913971","id":"20170222-115247_163469636","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T09:00:25+0100","dateFinished":"2017-02-27T09:00:25+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3645","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>2 Load Bokeh and redirect output to Zeppelin</h2>\n</div>"}]}},{"text":"%pyspark\nfrom bokeh.io import push_notebook, show, output_notebook\nfrom bokeh.layouts import row\nfrom bokeh.resources import Resources\nfrom bokeh.plotting import figure\n\noutput_notebook()\n","user":"anonymous","dateUpdated":"2017-02-27T08:53:14+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591125_-1376913971","id":"20170218-224440_1753132708","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:53:14+0100","dateFinished":"2017-02-27T08:53:14+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3646"},{"text":"%md \n## 3 Use Bokeh\n","user":"anonymous","dateUpdated":"2017-02-27T09:00:34+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488182211234_565231723","id":"20170227-085651_2071646843","dateCreated":"2017-02-27T08:56:51+0100","dateStarted":"2017-02-27T09:00:34+0100","dateFinished":"2017-02-27T09:00:34+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3647","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>3 Use Bokeh</h2>\n</div>"}]}},{"title":" Render a first plot","text":"%pyspark\nopts = dict(plot_width=250, plot_height=250, min_border=0)\np1 = figure(**opts)\nr1 = p1.circle([1,2,3], [4,5,6], size=20)\n\np2 = figure(**opts)\nr2 = p2.circle([1,2,3], [4,5,6], size=20)\n\nt = show(row(p1, p2), notebook_handle=True)\n","user":"anonymous","dateUpdated":"2017-02-27T08:48:34+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591126_-1375759724","id":"20170218-225316_1761670326","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:34+0100","dateFinished":"2017-02-27T08:48:34+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3648"},{"title":"And modify it via push_notebook","text":"%pyspark\nr1.glyph.fill_color = \"white\"\nr2.glyph.fill_color = \"orange\"\n\npush_notebook(handle=t)\n","user":"anonymous","dateUpdated":"2017-02-27T08:48:37+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591126_-1375759724","id":"20170219-102152_1345959524","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:37+0100","dateFinished":"2017-02-27T08:48:37+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3649"},{"text":"%pyspark\nfrom bokeh.io import output_file, show\nfrom bokeh.layouts import column\nfrom bokeh.plotting import figure\n\nx = list(range(11))\ny0 = x\ny1 = [10 - i for i in x]\ny2 = [abs(i - 5) for i in x]\n\n# create a new plot\ns1 = figure(width=250, plot_height=250, title=None)\ns1.circle(x, y0, size=10, color=\"navy\", alpha=0.5)\n\n# create another one\ns2 = figure(width=250, height=250, title=None)\ns2.triangle(x, y1, size=10, color=\"firebrick\", alpha=0.5)\n\n# create and another\ns3 = figure(width=250, height=250, title=None)\ns3.square(x, y2, size=10, color=\"olive\", alpha=0.5)\n\n# put the results in a column and show\nshow(column(s1, s2, s3))\n","user":"anonymous","dateUpdated":"2017-02-27T09:00:58+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591127_-1376144473","id":"20170220-211727_557875734","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:40+0100","dateFinished":"2017-02-27T08:48:40+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3651","title":"A multiple plot layout"},{"title":"Try to move the canvas in one plot!","text":"%pyspark\nfrom bokeh.io import output_file, show\nfrom bokeh.layouts import gridplot\nfrom bokeh.plotting import figure\n\nx = list(range(11))\ny0 = x\ny1 = [10-xx for xx in x]\ny2 = [abs(xx-5) for xx in x]\n\n# create a new plot\ns1 = figure(width=250, plot_height=250, title=None)\ns1.circle(x, y0, size=10, color=\"navy\", alpha=0.5)\n\n# create a new plot and share both ranges\ns2 = figure(width=250, height=250, x_range=s1.x_range, y_range=s1.y_range, title=None)\ns2.triangle(x, y1, size=10, color=\"firebrick\", alpha=0.5)\n\n# create a new plot and share only one range\ns3 = figure(width=250, height=250, x_range=s1.x_range, title=None)\ns3.square(x, y2, size=10, color=\"olive\", alpha=0.5)\n\np = gridplot([[s1, s2, s3]], toolbar_location=None)\n\n# show the results\nshow(p)","user":"anonymous","dateUpdated":"2017-02-27T08:48:43+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591127_-1376144473","id":"20170221-184932_909609162","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:43+0100","dateFinished":"2017-02-27T08:48:43+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3652"},{"title":"Try to select points in one plot!","text":"%pyspark\nfrom bokeh.io import output_file, show\nfrom bokeh.layouts import gridplot\nfrom bokeh.models import ColumnDataSource\nfrom bokeh.plotting import figure\n\nx = list(range(-20, 21))\ny0 = [abs(xx) for xx in x]\ny1 = [xx**2 for xx in x]\n\n# create a column data source for the plots to share\nsource = ColumnDataSource(data=dict(x=x, y0=y0, y1=y1))\n\nTOOLS = \"box_select,lasso_select,help\"\n\n# create a new plot and add a renderer\nleft = figure(tools=TOOLS, width=300, height=300, title=None)\nleft.circle('x', 'y0', source=source)\n\n# create another new plot and add a renderer\nright = figure(tools=TOOLS, width=300, height=300, title=None)\nright.circle('x', 'y1', source=source)\n\np = gridplot([[left, right]])\n\nshow(p)","user":"anonymous","dateUpdated":"2017-02-27T08:48:44+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591128_-1378068218","id":"20170221-185414_472033204","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:44+0100","dateFinished":"2017-02-27T08:48:45+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3653"},{"title":"Try to move the slider!","text":"%pyspark\nfrom bokeh.layouts import column\nfrom bokeh.models import CustomJS, ColumnDataSource, Slider\nfrom bokeh.plotting import Figure, output_file, show\n\n\nx = [x*0.005 for x in range(0, 200)]\ny = x\n\nsource = ColumnDataSource(data=dict(x=x, y=y))\n\nplot = Figure(plot_width=400, plot_height=400)\nplot.line('x', 'y', source=source, line_width=3, line_alpha=0.6)\n\ncallback = CustomJS(args=dict(source=source), code=\"\"\"\n    var data = source.data;\n    var f = cb_obj.value\n    x = data['x']\n    y = data['y']\n    for (i = 0; i < x.length; i++) {\n        y[i] = Math.pow(x[i], f)\n    }\n    source.trigger('change');\n\"\"\")\n\nslider = Slider(start=0.1, end=4, value=1, step=.1, title=\"power\")\nslider.js_on_change('value', callback)\n\nlayout = column(slider, plot)\n\nshow(layout)","user":"anonymous","dateUpdated":"2017-02-27T08:48:46+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591128_-1378068218","id":"20170221-190656_2134476265","dateCreated":"2017-02-27T08:46:31+0100","dateStarted":"2017-02-27T08:48:46+0100","dateFinished":"2017-02-27T08:48:47+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3654"},{"text":"%pyspark\n","dateUpdated":"2017-02-27T08:46:31+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488181591129_-1378452967","id":"20170225-124213_402551322","dateCreated":"2017-02-27T08:46:31+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3655"}],"name":"ZeppelinCommLayer Overview","id":"2CBTJ6R3V","angularObjects":{"2C8CW5MV1:shared_process":[{"name":"__zeppelin_comm_status__","object":"Shim initialized (do not delete this paragraph)","noteId":"2CBTJ6R3V"},{"name":"__zeppelin_comm_msg__","object":{"msg":{"html":"<script type=\"text/javascript\">\n(function(global) {\n  function now() {\n    return new Date();\n  }\n\n  var force = true;\n\n  if (typeof (window._bokeh_onload_callbacks) === \"undefined\" || force === true) {\n    window._bokeh_onload_callbacks = [];\n    window._bokeh_is_loading = undefined;\n  }\n\n\n  \n  if (typeof (window._bokeh_timeout) === \"undefined\" || force === true) {\n    window._bokeh_timeout = Date.now() + 5000;\n    window._bokeh_failed_load = false;\n  }\n\n  var NB_LOAD_WARNING = {'data': {'text/html':\n     \"<div style='background-color: #fdd'>\\n\"+\n     \"<p>\\n\"+\n     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n     \"</p>\\n\"+\n     \"<ul>\\n\"+\n     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n     \"</ul>\\n\"+\n     \"<code>\\n\"+\n     \"from bokeh.resources import INLINE\\n\"+\n     \"output_notebook(resources=INLINE)\\n\"+\n     \"</code>\\n\"+\n     \"</div>\"}};\n\n  function display_loaded() {\n    if (window.Bokeh !== undefined) {\n      document.getElementById(\"4b4acba7-624b-4a82-badd-b9daa7de22d0\").textContent = \"BokehJS successfully loaded.\";\n    } else if (Date.now() < window._bokeh_timeout) {\n      setTimeout(display_loaded, 100)\n    }\n  }\n\n  function run_callbacks() {\n    window._bokeh_onload_callbacks.forEach(function(callback) { callback() });\n    delete window._bokeh_onload_callbacks\n    console.info(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(js_urls, callback) {\n    window._bokeh_onload_callbacks.push(callback);\n    if (window._bokeh_is_loading > 0) {\n      console.log(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    }\n    if (js_urls == null || js_urls.length === 0) {\n      run_callbacks();\n      return null;\n    }\n    console.log(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n    window._bokeh_is_loading = js_urls.length;\n    for (var i = 0; i < js_urls.length; i++) {\n      var url = js_urls[i];\n      var s = document.createElement('script');\n      s.src = url;\n      s.async = false;\n      s.onreadystatechange = s.onload = function() {\n        window._bokeh_is_loading--;\n        if (window._bokeh_is_loading === 0) {\n          console.log(\"Bokeh: all BokehJS libraries loaded\");\n          run_callbacks()\n        }\n      };\n      s.onerror = function() {\n        console.warn(\"failed to load library \" + url);\n      };\n      console.log(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.getElementsByTagName(\"head\")[0].appendChild(s);\n    }\n  };var element = document.getElementById(\"4b4acba7-624b-4a82-badd-b9daa7de22d0\");\n  if (element == null) {\n    console.log(\"Bokeh: ERROR: autoload.js configured with elementid '4b4acba7-624b-4a82-badd-b9daa7de22d0' but no matching script tag was found. \")\n    return false;\n  }\n\n  var js_urls = [\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.js\", \"https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.4.min.js\"];\n\n  var inline_js = [\n    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\n    \n    function(Bokeh) {\n      \n      document.getElementById(\"4b4acba7-624b-4a82-badd-b9daa7de22d0\").textContent = \"BokehJS is loading...\";\n    },\n    function(Bokeh) {\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.css\");\n      console.log(\"Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.4.min.css\");\n      Bokeh.embed.inject_css(\"https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.4.min.css\");\n    }\n  ];\n\n  function run_inline_js() {\n    \n    if ((window.Bokeh !== undefined) || (force === true)) {\n      for (var i = 0; i < inline_js.length; i++) {\n        inline_js[i](window.Bokeh);\n      }if (force === true) {\n        display_loaded();\n      }} else if (Date.now() < window._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!window._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      window._bokeh_failed_load = true;\n    } else if (force !== true) {\n      var cell = $(document.getElementById(\"4b4acba7-624b-4a82-badd-b9daa7de22d0\")).parents('.cell').data().cell;\n      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n    }\n\n  }\n\n  if (window._bokeh_is_loading === 0) {\n    console.log(\"Bokeh: BokehJS loaded, going straight to plotting\");\n    run_inline_js();\n  } else {\n    load_libs(js_urls, function() {\n      console.log(\"Bokeh: BokehJS plotting callback run at\", now());\n      run_inline_js();\n    });\n  }\n}(this));</script>","div_id":"f7d8d1cb-3629-46ec-8412-2e181ba1268b"},"task":"publish"},"noteId":"2CBTJ6R3V"}],"2CBWP5YFP:shared_process":[],"2CBEDQHXY:shared_process":[],"2C97UNR7H:shared_process":[],"2C9CWX9EW:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}