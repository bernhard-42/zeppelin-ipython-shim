{"paragraphs":[{"text":"%pyspark\n\ndef versionCheck():\n    import sys\n    print(\"Python: \" + sys.version.replace(\"\\n\", \" - \"))\n    print(\"Spark:  \" + sc.version)\n\ndef display(html):\n    print(\"%angular\")\n    print(html)\n\ndef getNoteId():\n    return z.z.getInterpreterContext().getNoteId()\n\ndef getParagraphId():\n    return z.z.getInterpreterContext().getParagraphId()\n\n\nversionCheck()\n","user":"anonymous","dateUpdated":"2017-03-11T16:41:43+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Python: 3.5.2 |Anaconda 4.3.0 (x86_64)| (default, Jul  2 2016, 17:52:12)  - [GCC 4.2.1 Compatible Apple LLVM 4.2 (clang-425.0.28)]\nSpark:  2.1.0\n"}]},"apps":[],"jobName":"paragraph_1488557212094_-879325193","id":"20170226-205154_1841885464","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:41:43+0100","dateFinished":"2017-03-11T16:41:43+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:129614"},{"text":"%md\n## 1 Initialize ZeppelinCommLayer","user":"anonymous","dateUpdated":"2017-03-10T17:31:08+0100","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>1 Initialize ZeppelinCommLayer</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1488557212099_-893560902","id":"20170222-114829_709151521","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-10T17:31:08+0100","dateFinished":"2017-03-10T17:31:08+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129615"},{"title":"Import the Zeppelin Comm Layer, intialize it ...","text":"%pyspark\n\nfrom zeppelin_comm_layer import ZeppelinCommLayer, resetZeppelinCommLayer, LogLevel\n\n# resetZeppelinCommLayer(z.z)\nLogLevel().setLogLevel(\"DEBUG\")\n\nzcl = ZeppelinCommLayer(z.z)\n","user":"anonymous","dateUpdated":"2017-03-11T16:41:46+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<div id=\"__Zeppelin_Session_2C9HR8ADP_Comm__\">{{__zeppelin_comm_2C9HR8ADP_status__}}</div>\n\n"}]},"apps":[],"jobName":"paragraph_1488557212100_-895484647","id":"20170222-110000_685570517","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:41:46+0100","dateFinished":"2017-03-11T16:41:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129616"},{"title":"... and start it in the next (!) Zeppelin paragraph","text":"%pyspark\n\nzcl.start()\n","user":"anonymous","dateUpdated":"2017-03-11T16:41:50+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<div>You should now see<br><span style=\"margin:20px\"><i>ZeppelinSession started (do not delete this paragraph)</i></span></br>in the paragraph above</div>\n"}]},"apps":[],"jobName":"paragraph_1488557212102_-894715149","id":"20170226-221102_1708128437","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:41:50+0100","dateFinished":"2017-03-11T16:41:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129617"},{"text":"%md\n## 2 Use Bokeh\n\n**Note:** Without patching the global state of Bokeh for Zeppelin, push_notebook will only work when only one session with Bokeh is running on one Zeppelin session","user":"anonymous","dateUpdated":"2017-03-11T16:43:50+0100","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>2 Use Bokeh</h2>\n<p><strong>Note:</strong> Without patching the global state of Bokeh for Zeppelin, push_notebook will only work when only one session with Bokeh is running on one Zeppelin session</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1488557212103_-895099898","id":"20170222-115247_163469636","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:43:50+0100","dateFinished":"2017-03-11T16:43:50+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129619"},{"title":"Load Bokeh libraries and redirect output to Zeppelin Notebook","text":"%pyspark\nfrom bokeh.io import push_notebook, show, output_notebook\nfrom bokeh.layouts import row\nfrom bokeh.resources import Resources\nfrom bokeh.plotting import figure\n\noutput_notebook()\n","user":"anonymous","dateUpdated":"2017-03-11T16:43:52+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"<div id=\"a703d562-5a73-45ec-a1f3-9b5a19e36c63\"></div>\n"},{"type":"ANGULAR","data":"<div id=\"9b059925-1a06-436a-b970-809666f9d9fe\"></div>\n"}]},"apps":[],"jobName":"paragraph_1488557212105_-897408391","id":"20170218-224440_1753132708","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:43:52+0100","dateFinished":"2017-03-11T16:43:52+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129622"},{"title":" Render a first plot","text":"%pyspark\n#!zeppelin2md:images/bokeh-overview-1.gif\n\nopts = dict(plot_width=250, plot_height=250, min_border=0)\np1 = figure(**opts)\nr1 = p1.circle([1,2,3], [4,5,6], size=20)\n\np2 = figure(**opts)\nr2 = p2.circle([1,2,3], [4,5,6], size=20)\n\nhandle1 = show(row(p1, p2), notebook_handle=True)\n","user":"anonymous","dateUpdated":"2017-03-11T16:43:55+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488557212105_-897408391","id":"20170218-225316_1761670326","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:43:55+0100","dateFinished":"2017-03-11T16:43:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129623","errorMessage":""},{"title":"And modify it via push_notebook","text":"%pyspark\n\nr1.glyph.fill_color = \"yellow\"\nr2.glyph.fill_color = \"orange\"\n\npush_notebook(handle=handle1)\n\n","user":"anonymous","dateUpdated":"2017-03-11T16:43:59+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1488557212106_-896254144","id":"20170219-102152_1345959524","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:43:59+0100","dateFinished":"2017-03-11T16:43:59+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129624"},{"title":"Another dynamic plot","text":"%pyspark\n#!zeppelin2md:images/bokeh-overview-2.gif\n\nimport numpy as np\n\ndef update(f, handle, w=1, A=1, phi=0):\n    if   f == \"sin\": func = np.sin\n    elif f == \"cos\": func = np.cos\n    elif f == \"tan\": func = np.tan\n    r.data_source.data['y'] = A * func(w * x + phi)\n    push_notebook(handle=handle)\n    \nx = np.linspace(0, 2*np.pi, 2000)\ny = np.sin(x)\n\nplot2 = figure(title=\"simple line example\", plot_height=300, plot_width=600, y_range=(-5,5))\nr = plot2.line(x, y, color=\"#2222aa\", line_width=3)\n\nhandle2 = show(plot2, notebook_handle=True)\n","user":"anonymous","dateUpdated":"2017-03-11T16:44:02+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488557212106_-896254144","id":"20170302-174242_1092437584","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:44:02+0100","dateFinished":"2017-03-11T16:44:02+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129625","errorMessage":""},{"text":"%pyspark\nupdate(\"tan\", handle2)","user":"anonymous","dateUpdated":"2017-03-11T16:44:05+0100","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1488557212107_-896638893","id":"20170302-174402_1081888283","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:44:05+0100","dateFinished":"2017-03-11T16:44:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129626"},{"title":"A multiple plot layout","text":"%pyspark\n#!zeppelin2md:images/bokeh-overview-3.png\n\nfrom bokeh.io import output_file, show\nfrom bokeh.layouts import column\nfrom bokeh.plotting import figure\n\nx = list(range(11))\ny0 = x\ny1 = [10 - i for i in x]\ny2 = [abs(i - 5) for i in x]\n\n# create a new plot\ns1 = figure(width=250, plot_height=250, title=None)\ns1.circle(x, y0, size=10, color=\"navy\", alpha=0.5)\n\n# create another one\ns2 = figure(width=250, height=250, title=None)\ns2.triangle(x, y1, size=10, color=\"firebrick\", alpha=0.5)\n\n# create and another\ns3 = figure(width=250, height=250, title=None)\ns3.square(x, y2, size=10, color=\"olive\", alpha=0.5)\n\n# put the results in a row and show\nshow(row(s1, s2, s3))\n","user":"anonymous","dateUpdated":"2017-03-11T16:44:07+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488557212107_-896638893","id":"20170220-211727_557875734","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:44:08+0100","dateFinished":"2017-03-11T16:44:08+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:129627"},{"title":"Try to move the canvas in one plot!","text":"%pyspark\n#!zeppelin2md:images/bokeh-overview-4.png\n\nfrom bokeh.io import output_file, show\nfrom bokeh.layouts import gridplot\nfrom bokeh.plotting import figure\n\nx = list(range(11))\ny0 = x\ny1 = [10-xx for xx in x]\ny2 = [abs(xx-5) for xx in x]\n\n# create a new plot\ns1 = figure(width=250, plot_height=250, title=None)\ns1.circle(x, y0, size=10, color=\"navy\", alpha=0.5)\n\n# create a new plot and share both ranges\ns2 = figure(width=250, height=250, x_range=s1.x_range, y_range=s1.y_range, title=None)\ns2.triangle(x, y1, size=10, color=\"firebrick\", alpha=0.5)\n\n# create a new plot and share only one range\ns3 = figure(width=250, height=250, x_range=s1.x_range, title=None)\ns3.square(x, y2, size=10, color=\"olive\", alpha=0.5)\n\np = gridplot([[s1, s2, s3]])\n\n# show the results\nshow(p)","user":"anonymous","dateUpdated":"2017-03-11T16:44:11+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488557212108_-898562638","id":"20170221-184932_909609162","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:44:11+0100","dateFinished":"2017-03-11T16:44:12+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:129628"},{"title":"Try to select points in one plot!","text":"%pyspark\n#!zeppelin2md:images/bokeh-overview-5.png\n\nfrom bokeh.io import output_file, show\nfrom bokeh.layouts import gridplot\nfrom bokeh.models import ColumnDataSource\nfrom bokeh.plotting import figure\n\nx = list(range(-20, 21))\ny0 = [abs(xx) for xx in x]\ny1 = [xx**2 for xx in x]\n\n# create a column data source for the plots to share\nsource = ColumnDataSource(data=dict(x=x, y0=y0, y1=y1))\n\nTOOLS = \"box_select,lasso_select,help,save\"\n\n# create a new plot and add a renderer\nleft = figure(tools=TOOLS, width=300, height=300, title=None)\nleft.circle('x', 'y0', source=source)\n\n# create another new plot and add a renderer\nright = figure(tools=TOOLS, width=300, height=300, title=None)\nright.circle('x', 'y1', source=source)\n\np = gridplot([[left, right]])\n\nshow(p)","user":"anonymous","dateUpdated":"2017-03-11T16:44:14+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488557212109_-898947387","id":"20170221-185414_472033204","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:44:14+0100","dateFinished":"2017-03-11T16:44:15+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:129629"},{"title":"Try to move the slider!","text":"%pyspark\n#!zeppelin2md:images/bokeh-overview-6.gif\n\nfrom bokeh.layouts import column\nfrom bokeh.models import CustomJS, ColumnDataSource, Slider\nfrom bokeh.plotting import Figure, output_file, show\n\n\nx = [x*0.005 for x in range(0, 200)]\ny = x\n\nsource = ColumnDataSource(data=dict(x=x, y=y))\n\nplot = Figure(plot_width=400, plot_height=400)\nplot.line('x', 'y', source=source, line_width=3, line_alpha=0.6)\n\ncallback = CustomJS(args=dict(source=source), code=\"\"\"\n    var data = source.data;\n    var f = cb_obj.value\n    x = data['x']\n    y = data['y']\n    for (i = 0; i < x.length; i++) {\n        y[i] = Math.pow(x[i], f)\n    }\n    source.trigger('change');\n\"\"\")\n\nslider = Slider(start=0.1, end=4, value=1, step=.1, title=\"power\")\nslider.js_on_change('value', callback)\n\nlayout = column(slider, plot)\n\nshow(layout)","user":"anonymous","dateUpdated":"2017-03-11T16:44:19+0100","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1488557212110_-897793140","id":"20170221-190656_2134476265","dateCreated":"2017-03-03T17:06:52+0100","dateStarted":"2017-03-11T16:44:19+0100","dateFinished":"2017-03-11T16:44:19+0100","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:129630"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-03-11T08:44:49+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1489218289802_-691275957","id":"20170311-084449_1106426411","dateCreated":"2017-03-11T08:44:49+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:129635"}],"name":"ZeppelinCommLayer Overview","id":"2C9HR8ADP","angularObjects":{"2CA5R39SP:shared_process":[],"2C9PBPHP2:shared_process":[{"name":"__zeppelin_comm_2C9HR8ADP_status__","object":"Session initialized, can now be started in the next paragraph ...  (do not delete this paragraph)","noteId":"2C9HR8ADP"}],"2C9T35AYY:shared_process":[],"2CDENW1UJ:shared_process":[],"2CA3CRS2J:shared_process":[],"2CAVHABDX:shared_process":[],"2CARY5ZYS:shared_process":[],"2CB9RSR89:shared_process":[],"2CASZNT3R:shared_process":[],"2CA4UU9ZH:shared_process":[],"2CCYSWEBF:shared_process":[],"2CA17HE2U:shared_process":[],"2CCHGTGDY:shared_process":[],"2CACZ48YM:shared_process":[],"2C9R2RW8Y:shared_process":[],"2CCZZ351R:shared_process":[],"2C9RAHG2K:shared_process":[],"2CCWBCHAT:shared_process":[],"2C9MFUCEM:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}